{% load static %}

<div class="dash-card">
    <div class="header-divisor">
        <h4 class="sub-title sub-title-left">
            Iniciar Novo Plano de Plantio
        </h4>
    </div>

    <p class="text-marrom">
        Selecione um terreno cadastrado para iniciar a configuração detalhada do seu plano de safra.
    </p>

    <div class="form-field">
        <label for="terrenoSelect">Terrenos disponíveis:</label>
        <select id="terrenoSelect" class="form-field-input">
            <option value="" disabled selected>Carregando terrenos...</option>
        </select>
    </div>

    <div id="terrenoDetails" class="terreno-details-box">
        <p class="detail-title">Detalhes do Terreno Selecionado:</p>
        <ul class="detail-list">
            <li class="detail-item">
                <span>Nome:</span> <span id="detailNome">N/A</span>
            </li>
            <li class="detail-item">
                <span>Tamanho:</span> <span id="detailTamanho">0 ha</span>
            </li>
            <li class="detail-item">
                <span>Localização (Cidade):</span> <span id="detailLocalizacao">N/A</span>
            </li>
        </ul>
    </div>

    <div class="submit-action-container">
        <button id="selecionarBtn" type="submit" disabled class="action-btn-with-spinner">
            <span id="btnText">Selecione um Terreno</span>
            <span id="loadingSpinner" class="spinner hidden spinner-small"></span>
        </button>
        <p id="messageBox"></p>
    </div>
</div>

<div class="dash-card margin-top-20">
    <div class="header-divisor flex-space-between">
        <h4 class="sub-title sub-title-left-small">
            Planos de Plantio Recentes
        </h4>
        <a href="{% url 'plano:api_lista_planos' %}" class="link-verde">
            Ver Todos &rarr;
        </a>
    </div>

    <div id="planosListContainer" class="planos-list-container">
        <div id="planosLoading" class="loading-message-box">
            <span class="spinner spinner-medium"></span>
            <p>Carregando planos...</p>
        </div>

        <div id="planosEmpty" class="hidden empty-message-box">
            <p class="text-marrom-bold">Nenhum plano ativo encontrado.</p>
            <p>Use a seção acima para iniciar um novo plano.</p>
        </div>

        <ul id="planosList" class="terreno-list">
            </ul>
    </div>
</div>

<script>
    // Definição das URLs do Django, antes do carregamento do arquivo JS
    const API_TERRENOS_URL = "{% url 'plano:api_terrenos' %}";
    const WIZARD_START_URL = "{% url 'plano:iniciar_wizard' %}";
    const API_LISTA_PLANOS_URL = "{% url 'plano:api_lista_planos' %}";
    const PLANO_VISUALIZACAO_URL = "{% url 'plano:planofinal_plano' plano_id=0 %}";
</script>
<script src="{% static 'planodeplantio_app/js/bloco7.js' %}"></script>